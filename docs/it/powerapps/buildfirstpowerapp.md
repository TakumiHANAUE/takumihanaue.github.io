---
layout: default
title: 初めてアプリを作ってみる
nav_order: 1
parent: Microsoft Power Apps
---

# はじめに

突然ですが、私の所属している会社ではチームメンバーがいつテレワークするのかをExcelで管理している。
そのExcelファイルを仮に `テレワーク予定表.xlsx` とする

`テレワーク予定表.xlsx` の記載ルールは次の通り

- 月末に翌月分のテレワーク予定を記入
    - テレワークなら `T` と記入する
    - 出社なら `O` と記入する
- 当月中にテレワーク予定が変更になったら別の識別子で予定表を更新する
    - テレワークから出社への変更は `TO` に更新する
    - 出社からテレワークへの変更は `OT` に更新する

`テレワーク予定表.xlsx` は以下のようなテーブルになっている。

|メンバー|2022/1/1|2022/1/2|2022/1/3|...|2022/1/31|
|:--:|:--:|:--:|:--:|:--:|:--:|
|Aさん|O|O|T|...|T|
|Bさん|T|T|T|...|T|
|Cさん|O|O|O|...|O|
|Dさん|T|O|T|...|O|

このテレワーク予定の管理を Microsoft Power Apps を使うとどうなるのだろうか。  
試しに「テレワーク予定管理アプリ」なるものを作ってみようと思う。

**おことわり**

この記事では「Power Apps をどうやって使い始めるか」については書いていません。
Microsoft 365 を契約して・・・や、Microsoft 365 開発者プログラムに登録して・・・など方法がありますが、そのあたりについては他の方の記事を参照ください。

# Power Apps のキホンを学ぶ

ローコード・ノーコードで簡単にアプリが作れるといっても Power Apps のことをまったく知らずに使うは少し失礼かなと思い、Microsoft 公式のドキュメントを見てみる。  

Microsoft Learn の以下モジュール・ラーニングパスを行った。
- [Microsoft Power Platform の基本](https://docs.microsoft.com/ja-jp/learn/paths/power-plat-fundamentals/)  
このうち Power Apps に関わる以下モジュール
    - [Power Apps の概要](https://docs.microsoft.com/ja-jp/learn/modules/introduction-power-apps/)
    - [キャンバス アプリの構築方法](https://docs.microsoft.com/ja-jp/learn/modules/build-app-solution/)
    - [モデル駆動型アプリの構築方法](https://docs.microsoft.com/ja-jp/learn/modules/how-build-model-driven-app/)
    - [Power Apps ポータルの概要](https://docs.microsoft.com/ja-jp/learn/modules/introduction-power-apps-portals/)
- [Power Apps でキャンバス アプリを作成する](https://docs.microsoft.com/ja-jp/learn/paths/create-powerapps/
)

加えて、Power Apps の "Power Apps Training" テンプレート（下図）をつかってキャンバスアプリの概要を学んだ。

![Power Apps Training テンプレート](../assets/powerappstraining_template.png)

# Excelからキャンバスアプリを作る

今回のテーマ「テレワーク予定管理アプリ」はキャンバスアプリで作ってみることにした。  
（モデル駆動型アプリ・ポータルというのも作れるみたいだが、キャンバスアプリが一番シンプルに感じた）

## Excelのデータテーブルを用意する

以下のようなテーブルを用意する。
ひとまず2022年1月分だけ。
ファイルはExcel Onlineで作成し、OneDrive上に保存されている。

作ったテーブルには、

- ファイル名は **テレワーク予定01.xlsx** に設定
- シート名を **2022年1月** に設定
- テーブルとして書式設定
- 2022/1/1 だけ 仮データを入力

を行った。

**TODO : ウィンドウの**

![Excelのデータテーブルを用意する](../assets/maketable.gif)

## キャンバスアプリを作る

手順は以下の通り。

- Power Apps を開き、左メニューの **作成** を押す。
- **アプリを作成する** の **開始値** で **Excel** を選択する。
- **接続** の **新しい接続** を選択し、OneDrive を選択する。
- **Excelファイルの選択** で **テレワーク予定01.xlsx** を選択
- **テーブルの選択** で **テーブル１** を選択し、**接続** を押す

するとExcelファイルを基に自動でアプリが生成される。

![Excelのデータテーブルを用意する](../assets/genapps.gif)

## 作ったアプリをプレビューをしてみる

ウィンドウ右上の再生ボタン <img src="../assets/apppreview.png"> でアプリをプレビューしてみる。  
"×"ボタンを押すとプレビューは解除する。

### 画面１ (BrowseScreen1)

- 画面が4つに区切られていて、それぞれ">"マークが付いている
- 4つに区切られていることからExcelデータの各行に対応しているみたい

![アプリのプレビュー](../assets/previewapp_00.png)

### 画面２ (DetailScreen1)

">"ボタンを押すと次の画面。

- 8日分の情報が表示されている
- 2022/1/1はExcelで入れておいた値が表示されている
- 1/1と1/10～1/16が表示されている
    - 他の日の表示がない
    - ソートが日付順ではない

![アプリのプレビュー](../assets/previewapp_02.png)

### 画面３ (EditScreen1)

鉛筆ボタンを押すと編集画面。

- 各日付入力欄がある
- "✓"ボタンで入力内容を保存するみたい

![アプリのプレビュー](../assets/previewapp_04.png)

## アプリを修正する

### 画面１ (BrowseScreen1)

区切られた各領域にメンバーの名前を表示させてみる。

1. 画面左の **ツリービュー** の **画面** タブ から **BrowseScreen1** を展開する
1. 子要素の **BrowseGallery1** を選択する
1. 画面右の **プロパティ** から **レイアウト** を選択する
1. **タイトル、サブタイトル、本文** から **タイトル** に変更する
1. **フィールド** の **編集** を押す
1. **Title1** のプルダウンを開くと列名が表示されるので **メンバー** を選択する

すると、4つに区切られた画面それぞれにメンバーの名前が表示された。

![アプリを修正する_画面１](../assets/browseScreen.gif)

### 画面２ (DetailScreen1)

1月すべての日付を表示させてみる。

1. 画面左の **ツリービュー** の **画面** タブ から **DetailScreen1** を展開する
1. 子要素の **DetailForm1** を選択する
1. 画面右の **プロパティ** から **フィールドの編集** を押す
1. **フィールドの追加** を押す
1. 表示されていない日付をチェックして **追加** を押す
1. **フィールドの編集** からフィールドをドラッグして順序を日付順に並び変える

![アプリを修正する_画面２](../assets/detailScreen.gif)

### 画面３ (EditScreen1)

1月全ての入力欄を表示させてみる。

1. 画面左の **ツリービュー** の **画面** タブ から **EditScreen1** を展開する
1. 子要素の **EditForm1** を選択する
1. 画面右の **プロパティ** から **フィールドの編集** を押す
1. **フィールドの追加** を押す
1. 表示されていない日付をチェックして **追加** を押す
1. **フィールドの編集** からフィールドをドラッグして順序を日付順に並び変える

![アプリを修正する_画面３](../assets/editScreen.gif)

## 修正したアプリをもう一度プレビューしてみる

**作ったアプリをプレビューをしてみる** と同様にアプリをプレビューしてみる。

- **Aさん** の詳細画面に進み画面右上の <img src="../assets/editbutton.png"> ボタンを押し編集画面に移る。
- **2022/1/2** 入力欄に **T** を入力し、 <img src="../assets/savebutton.png"> ボタンを押す。

ここでプレビューを終了し、**戻る** ボタンを押して、アプリの編集画面を閉じる。
**テレワーク予定01.xlsx** を開くと、入力したデータが反映されていることがわかる。

![編集後のデータ](../assets/table_after.png)

## アプリを公開する

アプリの編集画面で **ファイル** を押し、左メニューの **保存** から **公開** ボタンを押す。
すると、

> 公開すると、アプリ使用のアクセス許可を持つ全てのユーザーに、このバージョンの使用が許可されます。

と表示が出るので **このバージョンを公開** を押すとアプリが公開される。
公開したアプリは Power Apps のホーム画面から起動することができるようだ。

# まとめ

Excelのデータテーブルを基に、比較的簡単にExcelにテレワーク予定を入力するアプリを作ることができた。
簡単なUI操作でデータ書き込みができるので、PC等に不慣れな人でも抵抗なく使ってもらえる気がする。
うまく使いこなせたらとても便利だと思った。

アプリ編集は "Power Apps Training" テンプレート を事前に見ていたのが役に立った。
どこの要素をいじったら何が変わるのか、初見でアプリ編集をしていくには少しハードルが高い気はした。

あと、以下の点がちょっと不満だった（単に知識不足だと思うが）。

- フィールドを日付順に並び変えるのが面倒くさい
- 入力値をドロップダウンで入力したい

このあたりの不満は次の機会に解決できればと思う。
