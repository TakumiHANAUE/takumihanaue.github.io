---
layout: default
title: フィールドの順序
nav_order: 5
parent: Microsoft Power Apps
grand_parent: IT
---

[こちら]({% link docs/it/powerapps/buildfirstpowerapp.md %}) の記事でExcelデータからキャンバスアプリを作った。
このとき、不満点として

> フィールドを日付順に並び変えるのが面倒くさい

というのを挙げた。

1/2/2022 よりも 1/10/2022 ～ 1/19/2022 が先にきてしまうのは、フィールドが日付の文字順にソートされているため。
日付部分が 01, 02, ... , 31 と2桁表記になれば、日付順にフィールドが並ぶはず。

## 表記を整えたExcel テーブルを作る

Excel データのタイトル行の日付部分(B1からAF1セル)を選択し、 **数値リボン** から **その他の表示形式** を選択する。
今回は `2012-03-14` という形式を選択した。

![日付の表示形式設定]({% link docs/it/powerapps/assets/dateformat.png %})

テーブルに書式設定してキャンバスアプリを生成してみる。

#### 補足

先にテーブルに書式設定した後では、 **その他の表示形式** を設定しても表示が変わらない（Ecxel Online, デスクトップ版ともに同じ挙動だった）

## キャンバスアプリを生成する

アプリを生成すると、 **DetailScreen1** のフィールドがはじめから日付順に表示されていることがわかる。

![日付の表示形式設定]({% link docs/it/powerapps/assets/correctfieldorder.png %})

# まとめ

Excelテーブルから生成されたキャンバスアプリはフィールドが文字列順に並ぶため、Excelテーブル作成時に適切な表示形式に設定しておく必要がある。
日付であれば 月日が2桁表記とするのが良い。
